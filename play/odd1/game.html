<!DOCTYPE html>
<html>

<head>
    <title>Odd Game</title>
    <link href="https://fonts.googleapis.com/css?family=McLaren&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">

    <style>
    @font-face {
        font-family: 'digital';
        src: url('digitalfont.woff') format('woff');
    }
    *,
    *:before,
    *:after {
        box-sizing: inherit;
    }
    html,
    body {
        margin: 0;
        padding: 0;
        font-family: 'McLaren', sans-serif;
        font-size: 18px;
        box-sizing: border-box;
        background-color: #2D2D2D;
        color: white;
        font-variant-numeric: tabular-nums;
    }
    #wrapper {
        display: grid;
        grid-template-rows: 70px auto 80px;
        grid-row-gap: 10px;
        padding: 10px;
        height: 100vh;
    }
    #top-bar {
        display: grid;
        text-align: center;
        align-items: center;
        background-color: rgba(255, 255, 255, 0.08);
        border-radius: 5px;
    }
    #canvas {
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr 1fr;
        grid-column-gap: 10px;
        grid-row-gap: 10px;
        height: 100%
    }
    @media screen and (orientation: landscape) {
        #canvas-wrapper {
            display: flex;
            justify-content: center;
        }
        #canvas {
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            width: 100vh;
        }
    }
    .character {
        background: url('guest.jpg');
        background-size: cover;
        background-position: center;
        border-radius: 5px;
        /* display: none; */
    }
    .character.target {
        background: url('thief.jpg');
        background-size: cover;
        background-position: center;
    }
    .character.wrong{
        border: 5px solid red;
    }

    .character.right{
        border: 5px solid blue;
    }

    .character:not(.target).hide {
      background-color: grey;
      animation-name: fade;
      animation-duration: 1s;
    }

    .character.hidden{
        opacity: 0.2;
    }

@keyframes fade {
  0%   {background-color: lightblue; opacity: 0.8;}

  80%  {background-color: lightblue; opacity: 0.2;transform: scale(1);}

  100% {background-color: lightblue; opacity: 0.0; transform: scale(0.1);}
}

    #scoreboard {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        grid-column-gap: 1px;
        text-align: center;
        border-radius: 5px;
        overflow: hidden;
    }
    #scoreboard div {
        background-color: rgba(255, 255, 255, 0.08);
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    #scoreboard .label {
        font-size: 12px;
        text-transform: uppercase;
        display: block;
        padding-bottom: 3px;
    }
    #scoreboard .value {
        font-size: 36px;
        font-family: 'digital', monospace;
    }
    </style>

    <script>
    var round = 0;
    var maxRounds = 2;
    var lapTime = 0;
    var lapTimeSec = 0;
    var totalTime = 0;
    var totalTimeSec = 0;
    var lapScore = 0;
    var totalScore = 0;
    var penalty = -10;
    var timer;

    var characters = document.getElementsByClassName("character");

    function loadGame(){
        // Add 'on click' event
        for (var i = 0; i < characters.length; i++) {
            characters[i].addEventListener("click", characterClicked);
        }

        function characterClicked(){
            // Clicked the target 
            if (this.classList.contains("target")){
                this.classList.add ("right");

                // Update score
                totalScore = totalScore +lapScore;
                document.getElementById("total-score").innerHTML = totalScore;

                // End the round
                endRound();
            
                // Start another round after 1 sec 
                if (round < maxRounds) {
                    setTimeout (startRound, 1000);
                }

            // Clicked NOT target
            } else {
                this.classList.add ("wrong");
                 // Apply penalty
                totalScore = totalScore - penalty;
                document.getElementById("total-score").innerHTML = totalScore;
            }
        }
    }

    function endRound(){
        clearInterval(timer);

        for (var i = 0; i < characters.length; i++) {
            characters[i].classList.add("hide");
        }

        // Check if it's the final round
        if (round >= maxRounds) {
            document.getElementById("action-button").innerHTML = "Final score " + totalScore;
            document.getElementById("action-button").onclick = function() {
                    location.reload();
                }

            // Disable charaters
            for (var i = 0; i < characters.length; i++) {
                characters[i].classList.remove('target', 'right');
                characters[i].classList.add("hidden");
            }
        }
    }


    function startRound() {

        //Reset characters
        for (var i = 0; i < characters.length; i++) {
            characters[i].classList.remove('hide', 'hidden', 'target','wrong','right' );
        }

        // Reset the lap timer
        lapTime = 0;

        // Update what round it is
        round++;
        document.getElementById("round").innerHTML = round;


        // Set the random theif
        var randomNumber = Math.floor(Math.random() * 6) + 1;
        canvas.children[randomNumber - 1].className = "character target";

        // Set the timer going (every 10 milliseconds)
        timer = setInterval(runTimer, 10);
    }

    function runTimer() {
        // Update lap time
        lapTime++;
        lapTimeSec = (lapTime / 100).toFixed(2);

        // Update total time 
        totalTime++;
        totalTimeSec = (totalTime / 100).toFixed(2);
        document.getElementById("total-time-sec").innerHTML = totalTimeSec;

        // Caculate lap score
        var maxScore = 50;
        var baseline = 80;
        lapScore = Math.round((maxScore * baseline) / (lapTime + baseline));
    }

    </script>
</head>

<body>
    <div id="wrapper">
        <div id="top-bar"><span id="description">Spot the odd person</span><span id="action-button" onclick="startRound();">Start</span>
        </div>
        <div id="canvas-wrapper">
            <div id="canvas">
                <div class="character hidden">1</div>
                <div class="character hidden">2</div>
                <div class="character hidden">3</div>
                <div class="character hidden">4</div>
                <div class="character hidden">5</div>
                <div class="character hidden">6</div>
            </div>
        </div>

        <div id="scoreboard">
            <div>
                <span class="label">Round</span>
                <span class="value" id="round">0</span>
            </div>
            <div>
                <span class="label">Timer</span>
                <span class="value" id="total-time-sec">0.00</span>
            </div>
            <div>
                <span class="label">Score</span>
                <span class="value" id="total-score">0</span>
            </div>
        </div>
    </div>


<script>loadGame();</script>


</body>




</html>
